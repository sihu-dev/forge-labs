# HEPHAITOS 기술 스택 시뮬레이션 결과

> **목적**: 트레이딩 교육 플랫폼 최적 기술 스택 도출
> **작성일**: 2025-12-19
> **버전**: v1.0

---

## 1. Frontend 프레임워크

### 비교 분석

| 옵션 | 성능 | 생산성 | 생태계 | 트레이딩 적합성 | 총점 |
|-----|-----|-------|-------|---------------|-----|
| **Next.js 15** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **19/20** |
| Remix | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | 15/20 |
| SvelteKit | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 15/20 |
| Astro | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 13/20 |

### 추천: **Next.js 15 (App Router)**

```
이유:
├── React Flow (블록 빌더) 완벽 지원
├── TradingView 차트 라이브러리 호환
├── Vercel 배포 최적화
├── 팀 러닝커브 최소화
└── Server Components로 초기 로딩 최적화
```

---

## 2. State Management

### 비교 분석

| 옵션 | 보일러플레이트 | TypeScript | DevTools | 번들크기 | 실시간 | 총점 |
|-----|-------------|-----------|----------|---------|-------|-----|
| **Zustand + TanStack Query** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | **23/25** |
| Jotai + TanStack Query | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 22/25 |
| Redux Toolkit | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | 20/25 |
| XState | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 19/25 |

### 추천: **Zustand + TanStack Query v5**

```typescript
// 클라이언트 상태 (Zustand)
const useStrategyStore = create<StrategyState>((set) => ({
  blocks: [],
  selectedBlock: null,
  addBlock: (block) => set((s) => ({ blocks: [...s.blocks, block] })),
}));

// 서버 상태 (TanStack Query)
const { data: backtestResult } = useQuery({
  queryKey: ['backtest', strategyId],
  queryFn: () => fetchBacktest(strategyId),
});
```

---

## 3. Backend/API 아키텍처

### 비교 분석

| 옵션 | 백테스트 성능 | 실시간 | 확장성 | 비용 | 복잡도 | 총점 |
|-----|------------|-------|-------|-----|-------|-----|
| **Supabase Edge + Python Worker** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | **21/25** |
| Next.js API + Vercel | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 18/25 |
| FastAPI 단독 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 20/25 |
| NestJS 단독 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 19/25 |

### 추천: **하이브리드 아키텍처**

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      HEPHAITOS 백엔드 아키텍처                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Next.js API Routes              Python Worker (Modal/Railway)         │
│   ─────────────────              ─────────────────────────────          │
│   • CRUD 작업                     • 백테스트 엔진                        │
│   • 인증/인가                     • 기술적 지표 계산                     │
│   • 결제 웹훅                     • 대용량 데이터 처리                   │
│                                                                         │
│           ↓                                  ↓                          │
│   ┌─────────────────────────────────────────────────────────────┐      │
│   │                    Supabase (PostgreSQL)                     │      │
│   │         + Edge Functions (실시간 트리거)                     │      │
│   └─────────────────────────────────────────────────────────────┘      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Database 최적화

### 비교 분석

| 옵션 | 시계열 성능 | JSON 쿼리 | 비용 | Supabase 통합 | RLS | 총점 |
|-----|----------|---------|-----|-------------|-----|-----|
| **Supabase + Redis** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **23/25** |
| Supabase + TimescaleDB | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 20/25 |
| Supabase 단독 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 23/25 |
| PlanetScale | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐ | ⭐⭐⭐ | 14/25 |

### 추천: **Supabase PostgreSQL + Upstash Redis**

```
데이터 분류:
─────────────
PostgreSQL (Supabase):
├── users, mentor_profiles     ← 관계형, RLS
├── courses, lessons           ← 관계형, RLS
├── enrollments, progress      ← 관계형, RLS
├── agents, strategies         ← JSONB (전략 정의)
└── payments, payouts          ← 관계형

Redis (Upstash):
├── 실시간 시세 캐시           ← TTL 1분
├── 세션 데이터                ← TTL 24시간
├── 백테스트 진행 상태         ← TTL 1시간
└── Rate Limiting              ← API 호출 제한
```

---

## 5. Real-time 기술

### 비교 분석

| 옵션 | CCU 처리 | 지연시간 | 비용 | Supabase 통합 | 총점 |
|-----|---------|--------|-----|-------------|-----|
| **Supabase Realtime** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **18/20** |
| Ably | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 16/20 |
| Pusher | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 14/20 |
| Liveblocks | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐ | 13/20 |

### 추천: **Supabase Realtime (기본) + Ably (협업)**

```
용도별 분류:
─────────────
Supabase Realtime (무료 티어 충분):
├── DB 변경 구독 (progress, payments)
├── 알림 전송
└── 기본 채팅

Ably (Phase 2, 협업 세션):
├── 고성능 협업 빌더 동기화
├── 타이핑 표시
└── 커서 동기화
```

---

## 6. Auth 솔루션

### 비교 분석

| 옵션 | 소셜 로그인 | RBAC | API 키 저장 | Supabase RLS | 비용 | 총점 |
|-----|----------|-----|----------|-------------|-----|-----|
| **Supabase Auth + Custom Claims** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **23/25** |
| NextAuth.js | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | 18/25 |
| Clerk | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐ | 19/25 |
| Lucia Auth | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 21/25 |

### 추천: **Supabase Auth + Custom Claims**

```typescript
// Custom Claims로 역할 관리
interface UserClaims {
  role: 'mentee' | 'mentor' | 'admin';
  mentor_tier?: 'basic' | 'premium';
  mentor_id?: string;
}

// RLS 정책에서 사용
CREATE POLICY "멘토만 강의 수정"
ON courses FOR UPDATE
USING (auth.jwt() ->> 'role' = 'mentor' AND mentor_id = auth.uid());
```

**API 키 저장**: Supabase Vault (암호화 저장)

---

## 7. Payment 통합

### 비교 분석

| 옵션 | 수수료 | 정산 주기 | 개발 편의 | 해외 결제 | 총점 |
|-----|-------|---------|---------|---------|-----|
| **Toss Payments** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | **17/20** |
| PortOne | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 16/20 |
| Stripe | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 18/20 |
| 카카오페이 직접 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐ | 12/20 |

### 추천: **Toss Payments (MVP) → PortOne (Scale)**

```
결제 플로우:
─────────────
1. 수강료 결제: Toss Payments (카드, 계좌이체, 간편결제)
2. 크레딧 충전: Toss Payments
3. 구독 결제: Toss Billing (Phase 2)

정산 자동화:
─────────────
• 매월 15일 자동 정산
• Supabase Function으로 정산금 계산
• 멘토 70% / 플랫폼 30% 자동 분배
```

---

## 8. Infra/Deployment

### 비교 분석

| 옵션 | 1K MAU 비용 | 100K MAU 비용 | 스케일링 | DevOps 복잡도 | 총점 |
|-----|-----------|-------------|---------|-------------|-----|
| **Vercel + Supabase + Modal** | $50 | $500 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **18/20** |
| Vercel + Supabase + Railway | $60 | $600 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 16/20 |
| AWS 풀스택 | $100 | $800 | ⭐⭐⭐⭐⭐ | ⭐⭐ | 14/20 |
| Fly.io 올인원 | $40 | $400 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 15/20 |

### 추천: **Vercel + Supabase + Modal**

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      배포 아키텍처                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Vercel                    Supabase                    Modal           │
│   ─────────                 ────────                    ─────           │
│   Next.js App               PostgreSQL                  Python Worker   │
│   Edge Functions            Realtime                    백테스트 엔진   │
│   Static Assets             Auth                        GPU (선택)      │
│                             Storage                                     │
│                                                                         │
│   비용: ~$20/월             비용: $25/월               비용: 사용량     │
│   (Pro Plan)                (Pro Plan)                  (~$5/월)        │
│                                                                         │
│   MVP 총 비용: ~$50/월                                                  │
│   100K MAU 예상: ~$500/월                                               │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 9. 최종 기술 스택

### MVP 스택 (Phase 1)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    HEPHAITOS MVP Tech Stack                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Frontend                                                              │
│   ─────────                                                             │
│   • Next.js 15 (App Router)                                             │
│   • TypeScript 5                                                        │
│   • Tailwind CSS 3                                                      │
│   • Zustand + TanStack Query v5                                         │
│   • React Flow (블록 빌더)                                              │
│   • Lightweight Charts (차트)                                           │
│                                                                         │
│   Backend                                                               │
│   ────────                                                              │
│   • Next.js API Routes (CRUD)                                           │
│   • Supabase Edge Functions (트리거)                                    │
│   • Modal (Python 백테스트)                                             │
│                                                                         │
│   Database                                                              │
│   ─────────                                                             │
│   • Supabase PostgreSQL                                                 │
│   • Upstash Redis (캐시)                                                │
│                                                                         │
│   Auth                                                                  │
│   ─────                                                                 │
│   • Supabase Auth (Google, Kakao)                                       │
│   • Custom Claims (RBAC)                                                │
│                                                                         │
│   Payment                                                               │
│   ────────                                                              │
│   • Toss Payments                                                       │
│                                                                         │
│   Infra                                                                 │
│   ──────                                                                │
│   • Vercel (프론트엔드)                                                 │
│   • Supabase (백엔드)                                                   │
│   • Modal (Python)                                                      │
│                                                                         │
│   예상 월 비용: $50-100                                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### Scale 스택 (Phase 2)

```
추가/변경:
──────────
• Ably (실시간 협업)
• PortOne (다중 PG)
• Cloudflare R2 (영상 저장)
• Sentry (에러 모니터링)
• PostHog (분석)

예상 월 비용: $300-500 (10K MAU 기준)
```

---

## 10. 기술 스택 의존성 그래프

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      의존성 그래프                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────┐                                                       │
│   │   Vercel    │                                                       │
│   │  (Next.js)  │                                                       │
│   └──────┬──────┘                                                       │
│          │                                                              │
│          ▼                                                              │
│   ┌──────────────────────────────────────────────────────────────┐     │
│   │                       Supabase                                │     │
│   │  ┌────────────┐  ┌──────────┐  ┌────────┐  ┌──────────────┐  │     │
│   │  │ PostgreSQL │  │ Realtime │  │  Auth  │  │   Storage    │  │     │
│   │  └────────────┘  └──────────┘  └────────┘  └──────────────┘  │     │
│   └──────────────────────────────────────────────────────────────┘     │
│          │                                                              │
│          ├──────────────────────┐                                       │
│          ▼                      ▼                                       │
│   ┌─────────────┐        ┌─────────────┐                               │
│   │   Modal     │        │   Upstash   │                               │
│   │  (Python)   │        │   (Redis)   │                               │
│   └─────────────┘        └─────────────┘                               │
│          │                                                              │
│          ▼                                                              │
│   ┌─────────────────────────────────────────────────────────────┐      │
│   │              External APIs                                   │      │
│   │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │      │
│   │  │   KIS   │  │ Alpaca  │  │  Toss   │  │ Binance │        │      │
│   │  └─────────┘  └─────────┘  └─────────┘  └─────────┘        │      │
│   └─────────────────────────────────────────────────────────────┘      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 11. 리스크 및 대안

| 리스크 | 확률 | 영향 | 대안 |
|-------|-----|-----|-----|
| Modal 가격 상승 | 중 | 중 | Railway, Fly.io |
| Supabase 장애 | 낮 | 높 | PlanetScale + Neon |
| Vercel 비용 폭발 | 중 | 중 | Cloudflare Pages |
| Toss API 변경 | 낮 | 중 | PortOne 전환 |

---

*기술 스택 시뮬레이션 v1.0*
*2025-12-19*
