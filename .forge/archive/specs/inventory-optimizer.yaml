# QRY-008: Inventory Optimizer
# FOLIO - 재고 최적화 및 발주 추천

query_id: QRY-008
app: folio
feature: inventory-optimizer
version: 1.0.0
created: 2025-12-19

# ═══════════════════════════════════════════════════════════════
# 개요
# ═══════════════════════════════════════════════════════════════
description: |
  매출 예측 기반 재고 최적화 및 자동 발주 추천 시스템.
  적정 재고량 유지로 재고 비용 최소화 및 품절 방지.

goals:
  - 품목별 적정 재고량 계산
  - 재발주점(ROP) 자동 산출
  - 경제적 주문량(EOQ) 계산
  - 안전 재고 산정
  - 발주 추천 및 알림

# ═══════════════════════════════════════════════════════════════
# 나노팩터 계층 구조
# ═══════════════════════════════════════════════════════════════
layers:
  L0_types:
    path: packages/types/src/folio/inventory.ts
    entities:
      - IInventoryItem (재고 품목)
      - IStockLevel (재고 수준)
      - IReorderPoint (재발주점)
      - IOrderRecommendation (발주 추천)
      - IInventoryConfig (설정)
      - ISupplier (공급업체)
      - IPurchaseOrder (발주서)

  L1_utils:
    path: packages/utils/src/inventory-calc.ts
    functions:
      - calculateEOQ: 경제적 주문량
      - calculateROP: 재발주점
      - calculateSafetyStock: 안전 재고
      - calculateTurnoverRate: 재고 회전율
      - calculateDaysOfSupply: 재고일수
      - calculateHoldingCost: 보관 비용
      - calculateStockoutRisk: 품절 위험도
      - classifyABC: ABC 분류

  L2_repositories:
    path: packages/core/src/repositories/inventory-repository.ts
    interfaces:
      - IInventoryRepository: 재고 CRUD
    implementations:
      - InMemoryInventoryRepository

  L3_agent:
    path: apps/folio/src/agents/inventory-optimizer-agent.ts
    class: InventoryOptimizerAgent
    methods:
      - analyzeInventory: 재고 분석
      - getReorderRecommendations: 발주 추천
      - optimizeStockLevels: 재고 수준 최적화
      - generatePurchaseOrders: 발주서 생성
      - getInventoryDashboard: 대시보드 데이터

# ═══════════════════════════════════════════════════════════════
# 재고 관리 모델
# ═══════════════════════════════════════════════════════════════
models:
  economic_order_quantity:
    formula: EOQ = √(2DS/H)
    variables:
      D: 연간 수요량
      S: 주문당 비용
      H: 단위당 연간 보관 비용

  reorder_point:
    formula: ROP = (d × L) + SS
    variables:
      d: 일평균 수요
      L: 리드타임 (일)
      SS: 안전 재고

  safety_stock:
    methods:
      - fixed_days: 고정 일수분
      - service_level: 서비스 수준 기반
      - demand_variability: 수요 변동성 기반

  abc_classification:
    A: 상위 20% 품목 (매출의 80%)
    B: 중위 30% 품목 (매출의 15%)
    C: 하위 50% 품목 (매출의 5%)

# ═══════════════════════════════════════════════════════════════
# 워크플로우
# ═══════════════════════════════════════════════════════════════
workflow:
  1_demand_analysis: |
    수요 분석
    - 과거 판매 데이터 분석
    - 계절성 패턴 파악
    - 매출 예측 연동

  2_inventory_classification: |
    재고 분류 (ABC)
    - 매출 기여도 기반 분류
    - 중요도별 관리 정책 적용

  3_parameter_calculation: |
    파라미터 계산
    - EOQ, ROP, 안전재고 산출
    - 품목별 최적화

  4_recommendation_generation: |
    발주 추천 생성
    - 현재 재고 vs ROP 비교
    - 발주량 및 시기 추천

  5_monitoring: |
    지속 모니터링
    - 재고 수준 실시간 추적
    - 품절 위험 알림
