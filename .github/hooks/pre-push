#!/bin/bash
# ============================================
# FORGE LABS Pre-Push Hook
# Push ì „ ìžë™ ê²€ì¦
# ============================================

# GPG ì„œëª… ë¹„í™œì„±í™” í™•ì¸
if [ "$(git config commit.gpgsign)" = "true" ]; then
    echo "âš ï¸  GPG signing enabled. Disabling for compatibility..."
    git config --local commit.gpgsign false
fi

# ë¸Œëžœì¹˜ í™•ì¸
BRANCH=$(git branch --show-current)
if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "master" ]; then
    echo "ðŸ“Œ Pushing to $BRANCH branch"
fi

# ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²´í¬ (100MB ì´ìƒ)
LARGE_FILES=$(git diff --cached --name-only | while read file; do
    if [ -f "$file" ]; then
        SIZE=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file" 2>/dev/null)
        if [ "$SIZE" -gt 104857600 ]; then
            echo "$file"
        fi
    fi
done)

if [ -n "$LARGE_FILES" ]; then
    echo "âš ï¸  Warning: Large files detected (>100MB):"
    echo "$LARGE_FILES"
    echo "Consider using Git LFS for these files."
fi

exit 0
